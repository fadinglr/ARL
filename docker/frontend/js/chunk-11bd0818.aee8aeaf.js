(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-11bd0818"],{"0487":function(t,e,a){"use strict";a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return i})),a.d(e,"b",(function(){return r}));var n=a("e20a"),s=function(t){return n.a.get("/scheduler/",{params:t})},i=function(t){return n.a.post("/scheduler/add/",t)},r=function(t){return n.a.post("/scheduler/delete/",t)}},"16f0":function(t,e,a){},"20a7":function(t,e,a){"use strict";var n=a("6271");a.n(n).a},4251:function(t,e,a){"use strict";var n=a("16f0");a.n(n).a},"5f90":function(t,e,a){"use strict";var n=a("a61c");a.n(n).a},6271:function(t,e,a){},8848:function(t,e,a){"use strict";var n=a("d17e");a.n(n).a},a61c:function(t,e,a){},d17e:function(t,e,a){},e6c5:function(t,e,a){"use strict";a.r(e),a("4160"),a("caad"),a("b0c0"),a("b64b"),a("d3b7"),a("2532"),a("159b");var n=a("5530"),s={props:{text:{type:String},record:{type:Object}}},i=(a("8848"),a("2877")),r=Object(i.a)(s,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("span",{staticClass:"ftColor",attrs:{title:t.text},on:{click:function(e){return t.$router.push({name:"groupAssetsManagement",query:{scope_id:t.record.scope_id}})}}},[t._v(t._s(t.text.length>26?t.text.slice(0,26)+"...":t.text))])])}),[],!1,null,"32e1790e",null).exports,c={props:{text:{type:String},record:{type:Object}},methods:{deleteTaskOption:function(t){this.$emit("operateCallback","delete",t)}}},o=(a("20a7"),Object(i.a)(c,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("span",{},[a("a-popconfirm",{attrs:{"ok-text":"确认","cancel-text":"取消"},on:{confirm:function(e){return t.deleteTaskOption(t.record._id)}}},[a("template",{slot:"title"},[a("p",[t._v("删除后无法恢复，确认删除吗？")])]),a("a-button",{staticClass:"operate-link"},[t._v("删除")])],2)],1)}),[],!1,null,"0cf76718",null).exports),u={props:{text:{type:String},record:{type:Object}}},l=(a("5f90"),[{title:"序号",dataIndex:"index",width:100},{title:"名称",dataIndex:"name",width:200},{title:"域名",dataIndex:"domain",width:200,sorter:!0},{width:280,title:"资产组范围ID",dataIndex:"scope_id",scopedSlots:{customRender:"scope_id",component:r}},{width:100,title:"运行间隔",dataIndex:"interval"},{width:250,title:"上一次运行日期",dataIndex:"last_run_date"},{width:250,title:"下一次运行日期",dataIndex:"next_run_date"},{width:120,title:"运行次数",sorter:!0,dataIndex:"run_number",scopedSlots:{customRender:"run_number",component:Object(i.a)(u,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("span",{staticClass:"ftColor",attrs:{title:t.text},on:{click:function(e){return t.$router.push({name:"taskList",query:{name:t.record.name,target:t.record.domain}})}}},[t._v(t._s(t.text.length>26?t.text.slice(0,26)+"...":t.text))])])}),[],!1,null,"2d1bbf81",null).exports}},{width:180,title:"操作",dataIndex:"operate",scopedSlots:{customRender:"operate",component:o}}]),d=[{name:"域名",key:"domain"},{name:"资产范围ID",key:"scope_id"}],p=a("0487"),h={data:function(){return{searchList:d,isLoading:!1,total:0,params:{page:1,size:10},selectedRowKeys:[],columns:l,dataList:[]}},mounted:function(){this.checkInitParams(),this.initData()},watch:{$route:function(t,e){this.checkInitParams(),this.initData()}},methods:{searchData:function(t,e){for(var a in this.params.page=1,this.params.size=10,this.$route.query[t]=e,this.$route.query)this.$route.query[a]||delete this.$route.query[a];this.$route.query.page=1,this.$route.query.size=10,this.$router.push({query:Object(n.a)(Object(n.a)({},this.$route.query),{},{ts:(new Date).getTime()})})},changeRowSelect:function(t){this.selectedRowKeys=t},checkInitParams:function(){for(var t in this.params={page:1,size:10},this.$route.query)["page","size"].includes(t)&&(this.$route.query[t]=parseInt(this.$route.query[t])),this.params[t]=this.$route.query[t]},changeCallback:function(t,e,a){var n;n=this.params.order?this.params.order.includes("-")?"":"-"+a.columnKey:a.columnKey,this.params.order=n,this.initData()},initData:function(){var t=this,e={};Object.keys(this.params).forEach((function(a){void 0!==t.params[a]&&t.params[a]&&(e[a]=t.params[a])})),this.isLoading=!0,Object(p.c)(Object(n.a)({},e)).then((function(e){200===e.code?(e.items.forEach((function(e,a){e.key=e._id,e.index=(t.params.page-1)*t.params.size+a+1+"",e.name=e.name?e.name:"-",e.run_number+="",e.interval=Math.round(e.interval/3600)+" 小时",Object.keys(e).forEach((function(t){t||(e[t]="-")}))})),t.dataList=e.items,t.total=e.total,document.querySelector("#contentWrap").scrollTop=0):t.dataList=[]})).finally((function(){t.isLoading=!1}))},optionFunction:function(t,e){switch(t){case"delete":this.deleteTaskOption(e)}},deleteTaskOption:function(t){var e=this;Object(p.b)({job_id:[t]}).then((function(t){200===t.code&&(e.$message.success("删除成功"),e.initData())}))},deleteSelectData:function(){var t=this;Object(p.b)({job_id:this.selectedRowKeys}).then((function(e){200===e.code&&(t.$message.success("删除成功"),t.selectedRowKeys=[],t.initData())}))},changeFunction:function(t,e){this.params.page=this.params.size===e?t:1,this.params.size=e,this.$route.query.page=this.params.page,this.$route.query.size=this.params.size,this.$router.push({query:Object(n.a)(Object(n.a)({},this.$route.query),{},{ts:(new Date).getTime()})})}}},m=(a("4251"),Object(i.a)(h,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"taskList table-wrap"},[a("div",{staticClass:"search-wrap"},t._l(t.searchList,(function(e){return a("span",{key:e.key,staticClass:"item"},[a("span",{staticClass:"label"},[t._v(t._s(e.name)+": ")]),a("a-input-search",{staticStyle:{width:"250px"},attrs:{allowClear:"",placeholder:"请输入"+e.name+"进行搜索"},on:{search:function(a){return t.searchData(e.key,t.params[e.key])}},model:{value:t.params[e.key],callback:function(a){t.$set(t.params,e.key,a)},expression:"params[item.key]"}})],1)})),0),a("batch-delete",{attrs:{selectedRowKeys:t.selectedRowKeys},on:{deleteCallback:t.deleteSelectData}}),a("table-component",{attrs:{columns:t.columns,isSelect:!0,isLoading:t.isLoading,selectedRowKeys:t.selectedRowKeys,tableList:t.dataList,pagination:!1,scroll:{x:1500},total:t.total,params:t.params},on:{selectRowCallback:t.changeRowSelect,turnPageCallback:t.changeFunction,operateCallback:t.optionFunction,changeCallback:t.changeCallback}})],1)}),[],!1,null,"3ff09401",null));e.default=m.exports}}]);